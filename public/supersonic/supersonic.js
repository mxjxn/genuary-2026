var B=class i{constructor(e){if(new.target===i)throw new Error("Transport is abstract - use SABTransport or PostMessageTransport");this._config=e,this._disposed=!1}get mode(){return this._config.mode}send(e,t){throw new Error("Abstract method - implement in subclass")}trySendDirect(e){throw new Error("Abstract method - implement in subclass")}onReply(e){throw new Error("Abstract method - implement in subclass")}onDebug(e){throw new Error("Abstract method - implement in subclass")}onError(e){throw new Error("Abstract method - implement in subclass")}getMetrics(){throw new Error("Abstract method - implement in subclass")}async initialize(){throw new Error("Abstract method - implement in subclass")}dispose(){this._disposed=!0}get ready(){throw new Error("Abstract method - implement in subclass")}};function oe(i,e,t){return(t-1-i+e)%t}function ae({uint8View:i,dataView:e,bufferStart:t,bufferSize:s,head:r,payload:n,sequence:a,messageMagic:c,headerSize:l}){let u=n.length,h=l+u+3&-4,p=s-r;if(h>p){let d=new Uint8Array(l),w=new DataView(d.buffer);w.setUint32(0,c,!0),w.setUint32(4,h,!0),w.setUint32(8,a,!0),w.setUint32(12,0,!0);let m=t+r,g=t;if(p>=l){i.set(d,m);let y=p-l;y>0&&i.set(n.subarray(0,y),m+l),i.set(n.subarray(y),g)}else{i.set(d.subarray(0,p),m),i.set(d.subarray(p),g);let y=l-p;i.set(n,g+y)}}else{let d=t+r;e.setUint32(d,c,!0),e.setUint32(d+4,h,!0),e.setUint32(d+8,a,!0),e.setUint32(d+12,0,!0),i.set(n,d+l)}return(r+h)%s}function ze(i,e,t=0){for(let s=0;s<=t;s++)if(Atomics.compareExchange(i,e,0,1)===0)return!0;return!1}function We(i,e){Atomics.store(i,e,0)}function ce({atomicView:i,dataView:e,uint8View:t,bufferConstants:s,ringBufferBase:r,controlIndices:n,oscMessage:a,maxSpins:c=0}){let l=a.length,u=s.MESSAGE_HEADER_SIZE+l;if(u>s.IN_BUFFER_SIZE-s.MESSAGE_HEADER_SIZE||!ze(i,n.IN_WRITE_LOCK,c))return!1;try{let f=Atomics.load(i,n.IN_HEAD),h=Atomics.load(i,n.IN_TAIL),p=u+3&-4;if(oe(f,h,s.IN_BUFFER_SIZE)<p)return!1;let w=Atomics.add(i,n.IN_SEQUENCE,1),m=ae({uint8View:t,dataView:e,bufferStart:r+s.IN_BUFFER_START,bufferSize:s.IN_BUFFER_SIZE,head:f,payload:a,sequence:w,messageMagic:s.MESSAGE_MAGIC,headerSize:s.MESSAGE_HEADER_SIZE});return Atomics.load(i,n.IN_HEAD),Atomics.store(i,n.IN_HEAD,m),!0}finally{We(i,n.IN_WRITE_LOCK)}}var $e=.2,M=class{#t;#e;#o;#i;#h;#r;#m;#a;#n;constructor({sharedBuffer:e,ringBufferBase:t,bufferConstants:s,getAudioContextTime:r,getNTPStartTime:n}){if(!e||!s)throw new Error("DirectWriter requires sharedBuffer and bufferConstants");if(typeof r!="function")throw new Error("DirectWriter requires getAudioContextTime callback");if(typeof n!="function")throw new Error("DirectWriter requires getNTPStartTime callback");this.#t=e,this.#e=t,this.#o=s,this.#i=r,this.#h=n,this.#l()}tryWrite(e){return!this.#r||!this.#n||!this.#d(e)?!1:ce({atomicView:this.#r,dataView:this.#m,uint8View:this.#a,bufferConstants:this.#o,ringBufferBase:this.#e,controlIndices:this.#n,oscMessage:e})}isBundle(e){return e.length>=8&&e[0]===35}#l(){this.#r=new Int32Array(this.#t),this.#m=new DataView(this.#t),this.#a=new Uint8Array(this.#t);let e=this.#o.CONTROL_START;this.#n={IN_HEAD:(this.#e+e+0)/4,IN_TAIL:(this.#e+e+4)/4,IN_SEQUENCE:(this.#e+e+24)/4,IN_WRITE_LOCK:(this.#e+e+40)/4}}#d(e){if(!this.isBundle(e)||e.length<16)return!0;let t=new DataView(e.buffer,e.byteOffset,e.byteLength),s=t.getUint32(8,!1),r=t.getUint32(12,!1);if(s===0&&(r===0||r===1))return!0;let n=this.#i(),a=this.#h();if(n===null||a===0)return!0;let c=n+a;return s+r/4294967296-c<$e}};var G=new Map;function le(i){try{return new URL(i,window.location.href).origin!==window.location.origin}catch{return!1}}async function ue(i){if(G.has(i))return G.get(i);let e=await fetch(i);if(!e.ok)throw new Error(`Failed to fetch ${i}: ${e.status} ${e.statusText}`);let t=await e.text(),s=new Blob([t],{type:"application/javascript"}),r=URL.createObjectURL(s);return G.set(i,r),r}async function R(i,e={}){let t=i;return le(i)&&(t=await ue(i)),new Worker(t,e)}async function he(i,e){let t=e;le(e)&&(t=await ue(e)),await i.addModule(t)}var v=class extends B{#t;#e;#o;#i;#h;#r;#m;#a;#n;#l;#d;#y;#f;#w;#g;#p=!1;#E;#s=0;#c=0;#u=0;#S=null;constructor(e){if(super({...e,mode:"sab"}),this.#t=e.sharedBuffer,this.#e=e.ringBufferBase,this.#o=e.bufferConstants,this.#y=e.workerBaseURL,this.#E=e.preschedulerCapacity||65536,!(this.#t instanceof SharedArrayBuffer))throw new Error("SABTransport requires a SharedArrayBuffer");this.#T(),this.#i=new M({sharedBuffer:this.#t,ringBufferBase:this.#e,bufferConstants:this.#o,getAudioContextTime:e.getAudioContextTime,getNTPStartTime:e.getNTPStartTime})}async initialize(){if(this.#p){console.warn("[SABTransport] Already initialized");return}let[e,t,s]=await Promise.all([R(this.#y+"osc_out_prescheduler_worker.js",{type:"module"}),R(this.#y+"osc_in_worker.js",{type:"module"}),R(this.#y+"debug_worker.js",{type:"module"})]);this.#n=e,this.#l=t,this.#d=s,this.#_(),await Promise.all([this.#A(this.#n,"OSC OUT",{maxPendingMessages:this.#E}),this.#A(this.#l,"OSC IN"),this.#A(this.#d,"DEBUG")]),this.#l.postMessage({type:"start"}),this.#d.postMessage({type:"start"}),this.#p=!0}send(e,t){return!this.#p||this._disposed?!1:(this.#n.postMessage({type:"send",oscData:e,sessionId:0,runTag:"",audioTimeS:null,currentTimeS:null}),this.#s++,this.#u+=e.length,!0)}trySendDirect(e){if(!this.#p||this._disposed)return!1;let t=this.#i.tryWrite(e);return t&&(this.#s++,this.#u+=e.length),t}sendWithOptions(e,t={}){if(!this.#p||this._disposed)return!1;let{sessionId:s=0,runTag:r="",audioTimeS:n=null,currentTimeS:a=null}=t;return this.#n.postMessage({type:"send",oscData:e,sessionId:s,runTag:r,audioTimeS:n,currentTimeS:a}),this.#s++,this.#u+=e.length,!0}sendImmediate(e){return!this.#p||this._disposed?!1:(this.#n.postMessage({type:"sendImmediate",oscData:e}),this.#s++,this.#u+=e.length,!0)}cancelSessionTag(e,t){this.#p&&this.#n.postMessage({type:"cancelSessionTag",sessionId:e,runTag:t})}cancelSession(e){this.#p&&this.#n.postMessage({type:"cancelSession",sessionId:e})}cancelTag(e){this.#p&&this.#n.postMessage({type:"cancelTag",runTag:e})}cancelAll(){this.#p&&this.#n.postMessage({type:"cancelAll"})}onReply(e){this.#f=e}onDebug(e){this.#w=e}onError(e){this.#g=e}getMetrics(){return{messagesSent:this.#s,messagesDropped:this.#c,bytesSent:this.#u}}get ready(){return this.#p&&!this._disposed}dispose(){this._disposed||(this.#n&&(this.#n.postMessage({type:"stop"}),this.#n.terminate(),this.#n=null),this.#l&&(this.#l.postMessage({type:"stop"}),this.#l.terminate(),this.#l=null),this.#d&&(this.#d.postMessage({type:"stop"}),this.#d.terminate(),this.#d=null),this.#p=!1,super.dispose())}#T(){this.#h=new Int32Array(this.#t),this.#r=new DataView(this.#t),this.#m=new Uint8Array(this.#t);let e=this.#o.CONTROL_START;this.#a={IN_HEAD:(this.#e+e+0)/4,IN_TAIL:(this.#e+e+4)/4,IN_SEQUENCE:(this.#e+e+24)/4,IN_WRITE_LOCK:(this.#e+e+40)/4}}#A(e,t,s={}){return new Promise((r,n)=>{let a=setTimeout(()=>{n(new Error(`${t} worker initialization timeout`))},5e3),c=l=>{l.data.type==="initialized"&&(clearTimeout(a),e.removeEventListener("message",c),r())};e.addEventListener("message",c),e.postMessage({type:"init",sharedBuffer:this.#t,ringBufferBase:this.#e,bufferConstants:this.#o,...s})})}#_(){this.#l.onmessage=e=>{let t=e.data;t.type==="messages"&&this.#f?t.messages.forEach(s=>{s.oscData&&this.#f(s.oscData,s.sequence)}):t.type==="error"&&(console.error("[SABTransport] OSC IN error:",t.error),this.#g&&this.#g(t.error,"oscIn"))},this.#d.onmessage=e=>{let t=e.data;t.type==="debug"&&this.#w?t.messages.forEach(s=>{this.#w(s)}):t.type==="error"&&(console.error("[SABTransport] DEBUG error:",t.error),this.#g&&this.#g(t.error,"debug"))},this.#n.onmessage=e=>{let t=e.data;t.type==="preschedulerMetrics"?this.#S=t.metrics:t.type==="error"&&(console.error("[SABTransport] OSC OUT error:",t.error),this.#c++,this.#g&&this.#g(t.error,"oscOut"))}}getPreschedulerMetrics(){return this.#S}};var C=class extends B{#t;#e;#o;#i;#h;#r;#m=null;#a=!1;#n;#l;#d=0;#y=0;#f=0;#w;#g;constructor(e){super({...e,mode:"postMessage"}),this.#o=e.workerBaseURL,this.#n=e.preschedulerCapacity||65536,this.#l=e.snapshotIntervalMs||25,this.#w=e.getAudioContextTime,this.#g=e.getNTPStartTime}async initialize(e){if(this.#a){console.warn("[PostMessageTransport] Already initialized");return}if(!e)throw new Error("PostMessageTransport requires workletPort");this.#t=e,this.#t.onmessage=t=>{this.#E(t.data)},this.#e=await R(this.#o+"osc_out_prescheduler_worker.js",{type:"module"}),this.#e.onmessage=t=>{this.#s(t.data)},await this.#p(),this.#a=!0}send(e,t){return!this.#a||this._disposed?!1:(this.#e.postMessage({type:"send",oscData:e,sessionId:0,runTag:"",audioTimeS:null,currentTimeS:null}),this.#d++,this.#f+=e.length,!0)}trySendDirect(e){return!1}sendWithOptions(e,t={}){if(!this.#a||this._disposed)return!1;let{sessionId:s=0,runTag:r="",audioTimeS:n=null,currentTimeS:a=null}=t;return this.#e.postMessage({type:"send",oscData:e,sessionId:s,runTag:r,audioTimeS:n,currentTimeS:a}),this.#d++,this.#f+=e.length,!0}sendImmediate(e){return!this.#a||this._disposed?!1:(this.#t.postMessage({type:"oscImmediate",oscData:e}),this.#d++,this.#f+=e.length,!0)}cancelSessionTag(e,t){this.#a&&this.#e.postMessage({type:"cancelSessionTag",sessionId:e,runTag:t})}cancelSession(e){this.#a&&this.#e.postMessage({type:"cancelSession",sessionId:e})}cancelTag(e){this.#a&&this.#e.postMessage({type:"cancelTag",runTag:e})}cancelAll(){this.#a&&this.#e.postMessage({type:"cancelAll"})}onReply(e){this.#i=e}onDebug(e){this.#h=e}onError(e){this.#r=e}handleDebugRaw(e){if(this.#e&&e.messages){let t=new TextDecoder("utf-8");for(let s of e.messages)try{let r=new Uint8Array(s.bytes),n=t.decode(r);n.endsWith(`
`)&&(n=n.slice(0,-1)),this.#h&&this.#h({text:n,timestamp:performance.now(),sequence:s.sequence})}catch(r){console.error("[PostMessageTransport] Failed to decode debug message:",r)}}}getPreschedulerMetrics(){return this.#m}getMetrics(){return{messagesSent:this.#d,messagesDropped:this.#y,bytesSent:this.#f}}get ready(){return this.#a&&!this._disposed}dispose(){this._disposed||(this.#e&&(this.#e.postMessage({type:"stop"}),this.#e.terminate(),this.#e=null),this.#t=null,this.#a=!1,super.dispose())}#p(){return new Promise((e,t)=>{let s=setTimeout(()=>{t(new Error("Prescheduler worker initialization timeout"))},5e3),r=n=>{n.data.type==="initialized"&&(clearTimeout(s),this.#e.removeEventListener("message",r),e())};this.#e.addEventListener("message",r),this.#e.postMessage({type:"init",mode:"postMessage",maxPendingMessages:this.#n,snapshotIntervalMs:this.#l})})}#E(e){switch(e.type){case"oscReplies":if(this.#i&&e.messages)for(let t of e.messages)t.oscData&&this.#i(t.oscData,t.sequence);break;case"debug":this.#h&&e.message&&this.#h(e.message);break;case"metrics":break;case"bufferLoaded":break;case"error":console.error("[PostMessageTransport] Worklet error:",e.error),this.#y++,this.#r&&this.#r(e.error,"worklet");break}}#s(e){switch(e.type){case"dispatch":this.#t&&e.oscData&&this.#t.postMessage({type:"osc",oscData:e.oscData,timestamp:e.timestamp});break;case"preschedulerMetrics":this.#m=e.metrics;break;case"error":console.error("[PostMessageTransport] Prescheduler error:",e.error),this.#y++,this.#r&&this.#r(e.error,"oscOut");break}}};function fe(i,e){if(i==="sab")return new v(e);if(i==="postMessage")return new C(e);throw new Error(`Unknown transport mode: ${i}. Use 'sab' or 'postMessage'`)}var Ve={5120:"i8",5121:"u8",5122:"i16",5123:"u16",5124:"i32",5125:"u32",5126:"f32"};var de={u8:1,u8c:1,i8:1,u16:2,i16:2,u32:4,i32:4,i64:8,u64:8,f32:4,f64:8};var He={f32:Float32Array,f64:Float64Array},Ge={i8:Int8Array,i16:Int16Array,i32:Int32Array},qe={u8:Uint8Array,u8c:Uint8ClampedArray,u16:Uint16Array,u32:Uint32Array},Ze={i64:BigInt64Array,u64:BigUint64Array},Ye={...He,...Ge,...qe},Qe=i=>{let e=Ve[i];return e!==void 0?e:i};function pe(i,...e){let t=Ze[i];return new(t||Ye[Qe(i)])(...e)}var O=(i,e)=>(e--,i+e&~e);var me=i=>typeof i=="number";var x=(i,e=t=>t!==void 0?": "+t:"")=>class extends Error{origMessage;constructor(t){super(i(t)+e(t)),this.origMessage=t!==void 0?String(t):""}};var je=x(()=>"Assertion failed"),q=(typeof process<"u"&&process.env!==void 0?process.env.UMBRELLA_ASSERTS:!import.meta.env||import.meta.env.MODE!=="production"||import.meta.env.UMBRELLA_ASSERTS||import.meta.env.VITE_UMBRELLA_ASSERTS)?(i,e)=>{if(typeof i=="function"&&!i()||!i)throw new je(typeof e=="function"?e():e)}:()=>{};var Ke=x(()=>"illegal argument(s)"),ge=i=>{throw new Ke(i)};var we=0,ye=1,Se=2,Ee=3,be=4,U=5,Te=6,Z=1,Y=2,Ae=7*4,Q=0,j=1,_=2*4,I=class{buf;start;u8;u32;state;constructor(e={}){if(this.buf=e.buf?e.buf:new ArrayBuffer(e.size||4096),this.start=e.start!=null?O(Math.max(e.start,0),4):0,this.u8=new Uint8Array(this.buf),this.u32=new Uint32Array(this.buf),this.state=new Uint32Array(this.buf,this.start,Ae/4),!e.skipInitialization){let t=e.align||8;q(t>=8,`invalid alignment: ${t}, must be a pow2 and >= 8`);let s=this.initialTop(t),r=e.end!=null?Math.min(e.end,this.buf.byteLength):this.buf.byteLength;s>=r&&ge(`insufficient address range (0x${this.start.toString(16)} - 0x${r.toString(16)})`),this.align=t,this.doCompact=e.compact!==!1,this.doSplit=e.split!==!1,this.minSplit=e.minSplit||16,this.end=r,this.top=s,this._free=0,this._used=0}}stats(){let e=s=>{let r=0,n=0;for(;s;)r++,n+=this.blockSize(s),s=this.blockNext(s);return{count:r,size:n}},t=e(this._free);return{free:t,used:e(this._used),top:this.top,available:this.end-this.top+t.size,total:this.buf.byteLength}}callocAs(e,t,s=0){let r=this.mallocAs(e,t);return r?.fill(s),r}mallocAs(e,t){let s=this.malloc(t*de[e]);return s?pe(e,this.buf,s,t):void 0}calloc(e,t=0){let s=this.malloc(e);return s&&this.u8.fill(t,s,s+e),s}malloc(e){if(e<=0)return 0;let t=O(e+_,this.align),s=this.end,r=this.top,n=this._free,a=0;for(;n;){let c=this.blockSize(n),l=n+c>=r;if(l||c>=t)return this.mallocTop(n,a,c,t,l);a=n,n=this.blockNext(n)}return n=r,r=n+t,r<=s?(this.initBlock(n,t,this._used),this._used=n,this.top=r,D(n)):0}mallocTop(e,t,s,r,n){if(n&&e+r>this.end)return 0;if(t?this.unlinkBlock(t,e):this._free=this.blockNext(e),this.setBlockNext(e,this._used),this._used=e,n)this.top=e+this.setBlockSize(e,r);else if(this.doSplit){let a=s-r;a>=this.minSplit&&this.splitBlock(e,r,a)}return D(e)}realloc(e,t){if(t<=0)return 0;let s=K(e),r=0,n=this._used,a=0;for(;n;){if(n===s){[r,a]=this.reallocBlock(n,t);break}n=this.blockNext(n)}return r&&r!==s&&this.u8.copyWithin(D(r),D(s),a),D(r)}reallocBlock(e,t){let s=this.blockSize(e),r=e+s,n=r>=this.top,a=O(t+_,this.align);if(a<=s){if(this.doSplit){let c=s-a;c>=this.minSplit?this.splitBlock(e,a,c):n&&(this.top=e+a)}else n&&(this.top=e+a);return[e,r]}return n&&e+a<this.end?(this.top=e+this.setBlockSize(e,a),[e,r]):(this.free(e),[K(this.malloc(t)),r])}reallocArray(e,t){if(e.buffer!==this.buf)return;let s=this.realloc(e.byteOffset,t*e.BYTES_PER_ELEMENT);return s?new e.constructor(this.buf,s,t):void 0}free(e){let t;if(me(e))t=e;else{if(e.buffer!==this.buf)return!1;t=e.byteOffset}t=K(t);let s=this._used,r=0;for(;s;){if(s===t)return r?this.unlinkBlock(r,s):this._used=this.blockNext(s),this.insert(s),this.doCompact&&this.compact(),!0;r=s,s=this.blockNext(s)}return!1}freeAll(){this._free=0,this._used=0,this.top=this.initialTop()}release(){return delete this.u8,delete this.u32,delete this.state,delete this.buf,!0}get align(){return this.state[be]}set align(e){this.state[be]=e}get end(){return this.state[Ee]}set end(e){this.state[Ee]=e}get top(){return this.state[Se]}set top(e){this.state[Se]=e}get _free(){return this.state[we]}set _free(e){this.state[we]=e}get _used(){return this.state[ye]}set _used(e){this.state[ye]=e}get doCompact(){return!!(this.state[U]&Z)}set doCompact(e){e?this.state[U]|=1<<Z-1:this.state[U]&=~Z}get doSplit(){return!!(this.state[U]&Y)}set doSplit(e){e?this.state[U]|=1<<Y-1:this.state[U]&=~Y}get minSplit(){return this.state[Te]}set minSplit(e){q(e>_,`illegal min split threshold: ${e}, require at least ${_+1}`),this.state[Te]=e}blockSize(e){return this.u32[(e>>2)+Q]}setBlockSize(e,t){return this.u32[(e>>2)+Q]=t,t}blockNext(e){return this.u32[(e>>2)+j]}setBlockNext(e,t){this.u32[(e>>2)+j]=t}initBlock(e,t,s){let r=e>>>2;return this.u32[r+Q]=t,this.u32[r+j]=s,e}unlinkBlock(e,t){this.setBlockNext(e,this.blockNext(t))}splitBlock(e,t,s){this.insert(this.initBlock(e+this.setBlockSize(e,t),s,0)),this.doCompact&&this.compact()}initialTop(e=this.align){return O(this.start+Ae+_,e)-_}compact(){let e=this._free,t=0,s=0,r,n=!1;for(;e;){for(r=e,s=this.blockNext(e);s&&r+this.blockSize(r)===s;)r=s,s=this.blockNext(s);if(r!==e){let a=r-e+this.blockSize(r);this.setBlockSize(e,a);let c=this.blockNext(r),l=this.blockNext(e);for(;l&&l!==c;){let u=this.blockNext(l);this.setBlockNext(l,0),l=u}this.setBlockNext(e,c),n=!0}e+this.blockSize(e)>=this.top&&(this.top=e,t?this.unlinkBlock(t,e):this._free=this.blockNext(e)),t=e,e=this.blockNext(e)}return n}insert(e){let t=this._free,s=0;for(;t&&!(e<=t);)s=t,t=this.blockNext(t);s?this.setBlockNext(s,e):this._free=e,this.setBlockNext(e,t)}},D=i=>i>0?i+_:0,K=i=>i>0?i-_:0;var _e=8,L=class{#t;#e;#o;#i;#h;#r;#m;#a;#n;#l;#d;#y;constructor(e){let{mode:t="sab",audioContext:s,sharedBuffer:r,bufferPoolConfig:n,sampleBaseURL:a,maxBuffers:c=1024,assetLoader:l=null,workletPort:u=null}=e;if(this.#t=t,!s)throw new Error("BufferManager requires audioContext");if(t==="sab"){if(!r||!(r instanceof SharedArrayBuffer))throw new Error("BufferManager requires sharedBuffer (SharedArrayBuffer) in SAB mode");if(!n||typeof n!="object")throw new Error("BufferManager requires bufferPoolConfig (object with start, size, align)");if(!Number.isFinite(n.start)||n.start<0)throw new Error("bufferPoolConfig.start must be a non-negative number");if(!Number.isFinite(n.size)||n.size<=0)throw new Error("bufferPoolConfig.size must be a positive number")}if(t==="postMessage"&&(!n||typeof n!="object"))throw new Error("BufferManager requires bufferPoolConfig in postMessage mode");if(!Number.isInteger(c)||c<=0)throw new Error("maxBuffers must be a positive integer");if(this.#i=s,this.#h=r,this.#e=a,this.#o=l,this.#y=u,t==="sab")this.#r=new I({buf:r,start:n.start,size:n.size,align:_e}),this.#m=n.size,this.#a=n.start;else{let p=new ArrayBuffer(n.start+n.size);this.#r=new I({buf:p,start:n.start,size:n.size,align:_e}),this.#m=n.size,this.#a=n.start}this.#n=new Map,this.#l=new Map,this.#d=new Map,this.GUARD_BEFORE=3,this.GUARD_AFTER=1,this.MAX_BUFFERS=c;let f=(n.size/(1024*1024)).toFixed(0),h=(n.start/(1024*1024)).toFixed(0)}setWorkletPort(e){if(this.#t==="postMessage"){if(!e)throw new Error("BufferManager.setWorkletPort() requires a valid port");this.#y=e}}#f(e){if(typeof e!="string"||e.length===0)throw new Error("Invalid audio path: must be a non-empty string");if(e.includes(".."))throw new Error(`Invalid audio path: path cannot contain '..' (got: ${e})`);if(e.includes("%2e")||e.includes("%2E"))throw new Error(`Invalid audio path: path cannot contain URL-encoded characters (got: ${e})`);if(e.includes("\\"))throw new Error(`Invalid audio path: use forward slashes only (got: ${e})`);if(e.includes("://")||e.startsWith("/")||e.startsWith("./"))return e;if(!this.#e)throw new Error(`sampleBaseURL not configured. Please set it in SuperSonic constructor options.
Example: new SuperSonic({ sampleBaseURL: "./dist/samples/" })
Or use CDN: new SuperSonic({ sampleBaseURL: "https://unpkg.com/supersonic-scsynth-samples@latest/samples/" })
Or install: npm install supersonic-scsynth-samples`);return this.#e+e}#w(e){if(!Number.isInteger(e)||e<0||e>=this.MAX_BUFFERS)throw new Error(`Invalid buffer number ${e} (must be 0-${this.MAX_BUFFERS-1})`)}async#g(e,t,s){let r=null,n=null,a=!1,c=await this.#S(e),l=!1;try{await this.#A(e);let{ptr:u,sizeBytes:f,numFrames:h,numChannels:p,sampleRate:d,source:w,...m}=await s();r=u;let{uuid:g,allocationComplete:y}=this.#u(e,t);n=g,this.#T(e,r,f,g,y,{numFrames:h,numChannels:p,sampleRate:d,source:w}),a=!0;let b=this.#_(e,g,y);return c(),l=!0,{ptr:r,uuid:g,allocationComplete:b,numFrames:h,numChannels:p,sampleRate:d,...m}}catch(u){throw a&&n?this.#B(e,n,!1):r&&this.#r.free(r),u}finally{l||c()}}async prepareFromBlob(e){let{bufnum:t,blob:s,startFrame:r=0,numFrames:n=0,channels:a=null}=e;if(this.#w(t),!s||!(s instanceof ArrayBuffer||ArrayBuffer.isView(s)))throw new Error("/b_allocFile requires audio data as ArrayBuffer or typed array");let c=s instanceof ArrayBuffer?s:s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength);return this.#g(t,3e4,async()=>{let l=await this.#i.decodeAudioData(c),u=Math.max(0,Math.floor(r||0)),f=l.length-u,h=n&&n>0?Math.min(Math.floor(n),f):f;if(h<=0)throw new Error(`No audio frames available for buffer ${t}`);let p=this.#p(a,l.numberOfChannels),d=p.length,w=h*d+(this.GUARD_BEFORE+this.GUARD_AFTER)*d,m=this.#E(w),g=new Float32Array(w),y=this.GUARD_BEFORE*d;for(let T=0;T<h;T++)for(let S=0;S<d;S++){let E=p[S],A=l.getChannelData(E);g[y+T*d+S]=A[u+T]}await this.#s(m,g);let b=g.length*4;return{ptr:m,sizeBytes:b,numFrames:h,numChannels:d,sampleRate:l.sampleRate}})}async prepareFromFile(e){let{bufnum:t,path:s,startFrame:r=0,numFrames:n=0,channels:a=null}=e;return this.#w(t),this.#g(t,6e4,async()=>{let c=this.#f(s),l=s.split("/").pop(),u=await this.#o.fetch(c,{type:"sample",name:l}),f=await this.#i.decodeAudioData(u),h=Math.max(0,Math.floor(r||0)),p=f.length-h,d=n&&n>0?Math.min(Math.floor(n),p):p;if(d<=0)throw new Error(`No audio frames available for buffer ${t} from ${s}`);let w=this.#p(a,f.numberOfChannels),m=w.length,g=d*m+(this.GUARD_BEFORE+this.GUARD_AFTER)*m,y=this.#E(g),b=new Float32Array(g),T=this.GUARD_BEFORE*m;for(let E=0;E<d;E++)for(let A=0;A<m;A++){let Fe=w[A],Ne=f.getChannelData(Fe);b[T+E*m+A]=Ne[h+E]}await this.#s(y,b);let S=b.length*4;return{ptr:y,sizeBytes:S,numFrames:d,numChannels:m,sampleRate:f.sampleRate,source:this.#t==="postMessage"?{type:"file",path:s,startFrame:r,numFrames:n,channels:a}:null}})}async prepareEmpty(e){let{bufnum:t,numFrames:s,numChannels:r=1,sampleRate:n=null}=e;if(this.#w(t),!Number.isFinite(s)||s<=0)throw new Error(`/b_alloc requires a positive number of frames (got ${s})`);if(!Number.isFinite(r)||r<=0)throw new Error(`/b_alloc requires a positive channel count (got ${r})`);let a=Math.floor(s),c=Math.floor(r);return this.#g(t,5e3,async()=>{let l=a*c+(this.GUARD_BEFORE+this.GUARD_AFTER)*c,u=this.#E(l),f=new Float32Array(l);await this.#s(u,f);let h=f.length*4;return{ptr:u,sizeBytes:h,numFrames:a,numChannels:c,sampleRate:n||this.#i.sampleRate}})}#p(e,t){return!e||e.length===0?Array.from({length:t},(s,r)=>r):(e.forEach(s=>{if(!Number.isInteger(s)||s<0||s>=t)throw new Error(`Channel ${s} is out of range (file has ${t} channels)`)}),e)}#E(e){let t=e*4,s=this.#r.malloc(t);if(s===0){let r=this.#r.stats(),n=((r.available||0)/(1024*1024)).toFixed(2),a=((r.total||0)/(1024*1024)).toFixed(2),c=(t/(1024*1024)).toFixed(2);throw new Error(`Buffer pool allocation failed: requested ${c}MB, available ${n}MB of ${a}MB total`)}return s}async#s(e,t){if(this.#t==="sab")new Float32Array(this.#h,e,t.length).set(t);else{let s=crypto.randomUUID(),r=new Promise((a,c)=>{let l=setTimeout(()=>{c(new Error("Buffer copy to WASM memory timed out"))},1e4),u=f=>{let h=f.data;h.type==="bufferCopied"&&h.copyId===s&&(this.#y.removeEventListener("message",u),clearTimeout(l),h.success?a():c(new Error(h.error||"Buffer copy failed")))};this.#y.addEventListener("message",u)}),n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);this.#y.postMessage({type:"copyBufferData",copyId:s,ptr:e,data:n},[n]),await r}}#c(e,t,s){return new Promise((r,n)=>{let a=setTimeout(()=>{this.#l.delete(e),n(new Error(`Buffer ${t} allocation timeout (${s}ms)`))},s);this.#l.set(e,{resolve:r,reject:n,timeout:a})})}#u(e,t){let s=crypto.randomUUID(),r=this.#c(s,e,t);return{uuid:s,allocationComplete:r}}async#S(e){let t=this.#d.get(e)||Promise.resolve(),s,r=new Promise(n=>{s=n});return this.#d.set(e,t.then(()=>r)),await t,()=>{s&&(s(),s=null),this.#d.get(e)===r&&this.#d.delete(e)}}#T(e,t,s,r,n,a={}){let c=this.#n.get(e),l={ptr:t,size:s,numFrames:a.numFrames||0,numChannels:a.numChannels||1,sampleRate:a.sampleRate||48e3,pendingToken:r,pendingPromise:n,previousAllocation:c?{ptr:c.ptr,size:c.size}:null,source:a.source||null};return this.#n.set(e,l),l}async#A(e){let t=this.#n.get(e);if(t&&t.pendingToken&&t.pendingPromise)try{await t.pendingPromise}catch{}}#_(e,t,s){return!s||typeof s.then!="function"?(this.#B(e,t,!0),Promise.resolve()):s.then(r=>(this.#B(e,t,!0),r)).catch(r=>{throw this.#B(e,t,!1),r})}#B(e,t,s){let r=this.#n.get(e);if(!r||r.pendingToken!==t)return;let n=r.previousAllocation;if(s){r.pendingToken=null,r.pendingPromise=null,r.previousAllocation=null,n?.ptr&&this.#r.free(n.ptr);return}r.ptr&&this.#r.free(r.ptr),r.pendingPromise=null,n?.ptr?this.#n.set(e,{ptr:n.ptr,size:n.size,pendingToken:null,previousAllocation:null}):this.#n.delete(e)}handleBufferFreed(e){let t=e[0],s=e[1],r=this.#n.get(t);if(!r){typeof s=="number"&&s!==0&&this.#r.free(s);return}if(typeof s=="number"&&s===r.ptr){this.#r.free(r.ptr),this.#n.delete(t);return}if(typeof s=="number"&&r.previousAllocation&&r.previousAllocation.ptr===s){this.#r.free(s),r.previousAllocation=null;return}this.#r.free(r.ptr),this.#n.delete(t)}handleBufferAllocated(e){let t=e[0],s=e[1],r=this.#l.get(t);r&&(clearTimeout(r.timeout),r.resolve({bufnum:s}),this.#l.delete(t))}allocate(e){let t=e*4,s=this.#r.malloc(t);if(s===0){let r=this.#r.stats(),n=((r.available||0)/(1024*1024)).toFixed(2),a=((r.total||0)/(1024*1024)).toFixed(2),c=(t/(1024*1024)).toFixed(2);console.error(`[BufferManager] Allocation failed: requested ${c}MB, available ${n}MB of ${a}MB total`)}return s}free(e){return this.#r.free(e)}getView(e,t){return new Float32Array(this.#h,e,t)}getStats(){return this.#r?this.#r.stats():{total:0,available:0,used:0,allocations:0}}getAllocatedBuffers(){let e=[];for(let[t,s]of this.#n.entries())!s||!s.ptr||e.push({bufnum:t,ptr:s.ptr,numFrames:s.numFrames,numChannels:s.numChannels,sampleRate:s.sampleRate,source:s.source||null});return e}updateAudioContext(e){if(!e)throw new Error("BufferManager.updateAudioContext requires audioContext");this.#i=e}getDiagnostics(){let e=this.#r.stats(),t=0,s=0;for(let r of this.#n.values())r&&(t+=r.size||0,r.pendingToken&&s++);return{active:this.#n.size,pending:s,bytesActive:t,pool:{total:this.#m,available:e.available||0,freeBytes:e.free?.size||0,freeBlocks:e.free?.count||0,usedBytes:e.used?.size||0,usedBlocks:e.used?.count||0}}}destroy(){for(let[e,t]of this.#l.entries())clearTimeout(t.timeout),t.reject(new Error("BufferManager destroyed"));this.#l.clear();for(let[e,t]of this.#n.entries())t.ptr&&this.#r.free(t.ptr);this.#n.clear(),this.#d.clear()}};var k=class{#t;#e;#o;constructor(e={}){let{onLoadingEvent:t=null,maxRetries:s=3,baseDelay:r=1e3}=e;this.#t=t,this.#e=s,this.#o=r}async fetch(e,{type:t,name:s}){let r=this.#i(e),n=this.#h(e),a=await r;this.#t?.("loading:start",{type:t,name:s,...a!=null&&{size:a}});let l=await(await n).arrayBuffer();return this.#t?.("loading:complete",{type:t,name:s,size:l.byteLength}),l}async#i(e){try{let t=await fetch(e,{method:"HEAD"});if(t.ok){let s=t.headers.get("Content-Length");return s?parseInt(s,10):null}return null}catch{return null}}async#h(e){let t;for(let s=0;s<=this.#e;s++)try{let r=await fetch(e);if(r.status>=400&&r.status<500)throw new Error(`Failed to fetch ${e}: ${r.status} ${r.statusText}`);if(!r.ok)throw new Error(`Server error fetching ${e}: ${r.status} ${r.statusText}`);return r}catch(r){if(t=r,r.message.includes("Failed to fetch")&&r.message.includes("4"))throw r;if(s<this.#e){let n=this.#o*Math.pow(2,s);await this.#r(n)}}throw t}#r(e){return new Promise(t=>setTimeout(t,e))}};var F=class{#t;#e;constructor({bufferManager:e,getDefaultSampleRate:t}){if(!e)throw new Error("OSCRewriter requires bufferManager");if(typeof t!="function")throw new Error("OSCRewriter requires getDefaultSampleRate callback");this.#t=e,this.#e=t}async rewritePacket(e){if(e&&e.address){let{message:t,changed:s}=await this.#o(e);return{packet:t,changed:s}}if(this.#n(e)){let t=await Promise.all(e.packets.map(n=>this.rewritePacket(n)));if(!t.some(n=>n.changed))return{packet:e,changed:!1};let r=t.map(n=>n.packet);return{packet:{timeTag:e.timeTag,packets:r},changed:!0}}return{packet:e,changed:!1}}async#o(e){switch(e.address){case"/b_alloc":return{message:await this.#i(e),changed:!0};case"/b_allocRead":return{message:await this.#h(e),changed:!0};case"/b_allocReadChannel":return{message:await this.#r(e),changed:!0};case"/b_allocFile":return{message:await this.#m(e),changed:!0};default:return{message:e,changed:!1}}}async#i(e){let t=this.#g(e.args,0,"/b_alloc requires a buffer number"),s=this.#g(e.args,1,"/b_alloc requires a frame count"),r=2,n=1,a=this.#e();this.#c(this.#f(e.args,r))&&(n=Math.max(1,this.#p(e.args,r,1)),r++),this.#f(e.args,r)?.type==="b"&&r++,this.#c(this.#f(e.args,r))&&(a=this.#w(this.#f(e.args,r)));let c=await this.#t.prepareEmpty({bufnum:t,numFrames:s,numChannels:n,sampleRate:a});return this.#u(c.allocationComplete,`/b_alloc ${t}`),this.#a(t,c)}async#h(e){let t=this.#g(e.args,0,"/b_allocRead requires a buffer number"),s=this.#E(e.args,1,"/b_allocRead requires a file path"),r=this.#p(e.args,2,0),n=this.#p(e.args,3,0),a=await this.#t.prepareFromFile({bufnum:t,path:s,startFrame:r,numFrames:n});return this.#u(a.allocationComplete,`/b_allocRead ${t}`),this.#a(t,a)}async#r(e){let t=this.#g(e.args,0,"/b_allocReadChannel requires a buffer number"),s=this.#E(e.args,1,"/b_allocReadChannel requires a file path"),r=this.#p(e.args,2,0),n=this.#p(e.args,3,0),a=[];for(let l=4;l<(e.args?.length||0)&&this.#c(e.args[l]);l++)a.push(Math.floor(this.#w(e.args[l])));let c=await this.#t.prepareFromFile({bufnum:t,path:s,startFrame:r,numFrames:n,channels:a.length>0?a:null});return this.#u(c.allocationComplete,`/b_allocReadChannel ${t}`),this.#a(t,c)}async#m(e){let t=this.#g(e.args,0,"/b_allocFile requires a buffer number"),s=this.#s(e.args,1,"/b_allocFile requires audio file data as blob"),r=await this.#t.prepareFromBlob({bufnum:t,blob:s});return this.#u(r.allocationComplete,`/b_allocFile ${t}`),this.#a(t,r)}#a(e,t){return{address:"/b_allocPtr",args:[this.#l(e),this.#l(t.ptr),this.#l(t.numFrames),this.#l(t.numChannels),this.#d(t.sampleRate),this.#y(t.uuid)]}}#n(e){return e&&e.timeTag!==void 0&&Array.isArray(e.packets)}#l(e){return{type:"i",value:Math.floor(e)}}#d(e){return{type:"f",value:e}}#y(e){return{type:"s",value:String(e)}}#f(e,t){if(Array.isArray(e))return e[t]}#w(e){if(e!=null)return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"value")?e.value:e}#g(e,t,s){let r=this.#w(this.#f(e,t));if(!Number.isFinite(r))throw new Error(s);return Math.floor(r)}#p(e,t,s=0){let r=this.#w(this.#f(e,t));return Number.isFinite(r)?Math.floor(r):s}#E(e,t,s){let r=this.#w(this.#f(e,t));if(typeof r!="string")throw new Error(s);return r}#s(e,t,s){let r=this.#f(e,t);if(!r||r.type!=="b")throw new Error(s);let n=this.#w(r);if(!(n instanceof Uint8Array||n instanceof ArrayBuffer))throw new Error(s);return n}#c(e){if(!e)return!1;let t=this.#w(e);return Number.isFinite(t)}#u(e,t){!e||typeof e.catch!="function"||e.catch(s=>{console.error(`[OSCRewriter] ${t} allocation failed:`,s)})}};function X(i){if(!i)return null;if(typeof i=="string")return(i.split("/").filter(Boolean).pop()||i).replace(/\.scsyndef$/i,"");let e=i instanceof ArrayBuffer?new Uint8Array(i):i;if(!(e instanceof Uint8Array)||e.length<11||e[0]!==83||e[1]!==67||e[2]!==103||e[3]!==102)return null;let t=e[10];if(t===0||11+t>e.length)return null;try{return new TextDecoder().decode(e.slice(11,11+t))}catch{return null}}var N=class{#t=new Map;on(e,t){if(typeof t!="function")throw new Error("Callback must be a function");return this.#t.has(e)||this.#t.set(e,new Set),this.#t.get(e).add(t),()=>this.off(e,t)}off(e,t){let s=this.#t.get(e);return s&&s.delete(t),this}once(e,t){let s=(...r)=>{this.off(e,s),t(...r)};return this.on(e,s)}removeAllListeners(e){return e===void 0?this.#t.clear():this.#t.delete(e),this}hasListeners(e){let t=this.#t.get(e);return t?t.size>0:!1}emit(e,...t){let s=this.#t.get(e);if(s)for(let r of s)try{r(...t)}catch(n){console.error(`[EventEmitter] Error in ${e} listener:`,n)}}async emitAsync(e,...t){let s=this.#t.get(e);if(s)for(let r of s)try{await r(...t)}catch(n){console.error(`[EventEmitter] Error in ${e} listener:`,n)}}clearAllListeners(){this.#t.clear()}};var z=class{#t;#e;#o;#i;#h;#r;#m=null;constructor(e={}){this.#i=e.mode||"sab",this.#t=e.sharedBuffer||null,this.#e=e.ringBufferBase||0,this.#o=e.bufferConstants||null}initSharedViews(e,t,s){if(this.#t=e,this.#e=t,this.#o=s,this.#i==="sab"&&e&&s){this.#h=new Int32Array(e);let r=t+s.METRICS_START;this.#r=new Uint32Array(e,r,s.METRICS_SIZE/4)}}updateSnapshot(e){this.#m=e}getSnapshotBuffer(){return this.#m}getMetricsView(){return this.#r}addMetric(e,t=1){if(!this.#r)return;let r={mainMessagesSent:22,mainBytesSent:23,preschedulerBypassed:25}[e];r!==void 0&&Atomics.add(this.#r,r,t)}parseMetricsBuffer(e){return{workletProcessCount:e[0],workletMessagesProcessed:e[1],workletMessagesDropped:e[2],workletSchedulerDepth:e[3],workletSchedulerMax:e[4],workletSchedulerDropped:e[5],workletSequenceGaps:e[24],preschedulerPending:e[6],preschedulerPeak:e[7],preschedulerSent:e[8],preschedulerRetriesSucceeded:e[9],preschedulerRetriesFailed:e[10],preschedulerBundlesScheduled:e[11],preschedulerEventsCancelled:e[12],preschedulerTotalDispatches:e[13],preschedulerMessagesRetried:e[14],preschedulerRetryQueueSize:e[15],preschedulerRetryQueueMax:e[16],preschedulerBypassed:e[25],oscInMessagesReceived:e[17],oscInMessagesDropped:e[18],oscInBytesReceived:e[19],debugMessagesReceived:e[20],debugBytesReceived:e[21],mainMessagesSent:e[22],mainBytesSent:e[23]}}getSABMetrics(){return this.#r?this.parseMetricsBuffer(this.#r):null}getBufferUsage(){if(!this.#h||!this.#o||!this.#e)return null;let e=this.#e+this.#o.CONTROL_START,t=this.#o,s=this.#h,r=Atomics.load(s,(e+0)/4),n=Atomics.load(s,(e+4)/4),a=Atomics.load(s,(e+8)/4),c=Atomics.load(s,(e+12)/4),l=Atomics.load(s,(e+16)/4),u=Atomics.load(s,(e+20)/4),f=(r-n+t.IN_BUFFER_SIZE)%t.IN_BUFFER_SIZE,h=(a-c+t.OUT_BUFFER_SIZE)%t.OUT_BUFFER_SIZE,p=(l-u+t.DEBUG_BUFFER_SIZE)%t.DEBUG_BUFFER_SIZE;return{inBufferUsed:{bytes:f,percentage:f/t.IN_BUFFER_SIZE*100},outBufferUsed:{bytes:h,percentage:h/t.OUT_BUFFER_SIZE*100},debugBufferUsed:{bytes:p,percentage:p/t.DEBUG_BUFFER_SIZE*100}}}overlayPreschedulerMetrics(e){if(!this.#m||!e)return;let t=new Uint32Array(this.#m,0,32),s=6,r=16-s+1;t.set(e.subarray(s,s+r),s)}gatherMetrics(e={}){let t=performance.now(),s;if(this.#i==="postMessage")if(e.preschedulerMetrics&&this.overlayPreschedulerMetrics(e.preschedulerMetrics),this.#m){let n=new Uint32Array(this.#m,0,32);s=this.parseMetricsBuffer(n)}else s={};else{s=this.getSABMetrics()||{};let n=this.getBufferUsage();n&&Object.assign(s,n)}e.driftOffsetMs!==void 0&&(s.driftOffsetMs=e.driftOffsetMs),e.audioContextState&&(s.audioContextState=e.audioContextState),e.bufferPoolStats&&(s.bufferPoolUsedBytes=e.bufferPoolStats.used.size,s.bufferPoolAvailableBytes=e.bufferPoolStats.available,s.bufferPoolAllocations=e.bufferPoolStats.used.count),e.loadedSynthDefsCount!==void 0&&(s.loadedSynthDefs=e.loadedSynthDefsCount);let r=performance.now()-t;return r>1&&console.warn(`[MetricsReader] Slow metrics gathering: ${r.toFixed(2)}ms`),s}get bufferConstants(){return this.#o}get ringBufferBase(){return this.#e}get sharedBuffer(){return this.#t}};function Oe(i){return i/1e3+2208988800}function De(i,e){return i-e}var W=class{#t;#e;#o;#i;#h;#r;#m;#a;#n=0;#l=null;constructor(e={}){this.#t=e.mode||"sab",this.#e=e.audioContext,this.#o=e.workletPort||null}initSharedViews(e,t,s){this.#h=t,this.#i=s,this.#t==="sab"&&e&&s&&(this.#r=new Float64Array(e,t+s.NTP_START_TIME_START,1),this.#m=new Int32Array(e,t+s.GLOBAL_OFFSET_START,1))}setWorkletPort(e){this.#o=e}updateAudioContext(e){this.#e=e}async initialize(){if(!this.#i||!this.#e)return;let e;for(;e=this.#e.getOutputTimestamp(),!(e.contextTime>0);)await new Promise(t=>setTimeout(t,50));this.#d(e)}#d(e){let t=performance.timeOrigin+e.performanceTime,s=Oe(t),r=De(s,e.contextTime);this.#a=r,this.#t==="sab"&&this.#r?this.#r[0]=r:this.#o&&this.#o.postMessage({type:"setNTPStartTime",ntpStartTime:r})}resync(){if(!this.#e)return;let e=this.#e.getOutputTimestamp();!e||e.contextTime<=0||this.#d(e)}startDriftTimer(){this.stopDriftTimer(),this.#l=setInterval(()=>{this.resync()},15e3)}stopDriftTimer(){this.#l&&(clearInterval(this.#l),this.#l=null)}getNTPStartTime(){return this.#r?this.#r[0]:this.#a??0}getGlobalOffset(){return this.#m?Atomics.load(this.#m,0):this.#n}calculateBundleWait(e){if(e.length<16||String.fromCharCode.apply(null,e.slice(0,8))!=="#bundle\0")return null;let s=this.getNTPStartTime();if(s===0)return console.warn("[NTPTiming] NTP start time not yet initialized"),null;let n=this.getGlobalOffset()/1e3,a=s+n,c=new DataView(e.buffer,e.byteOffset),l=c.getUint32(8,!1),u=c.getUint32(12,!1);if(l===0&&(u===0||u===1))return null;let h=l+u/4294967296-a,p=this.#e?.currentTime??0;return{audioTimeS:h,currentTimeS:p}}reset(){this.stopDriftTimer(),this.#a=void 0,this.#n=0,this.#r=null,this.#m=null}};var $=class{#t;#e;#o;constructor(e={}){this.#t=e.sharedBuffer||null,this.#e=e.bufferConstants||null,this.#o=e.ringBufferBase||0}update(e,t,s){this.#t=e,this.#o=t,this.#e=s}isAvailable(){return!!(this.#t&&this.#e)}start(){if(!this.isAvailable())throw new Error("AudioCapture not initialized");let e=this.#e,t=this.#o+e.AUDIO_CAPTURE_START,s=new Uint32Array(this.#t,t,4);Atomics.store(s,1,0),Atomics.store(s,0,1)}stop(){if(!this.isAvailable())throw new Error("AudioCapture not initialized");let e=this.#e,t=this.#o+e.AUDIO_CAPTURE_START,s=new Uint32Array(this.#t,t,4);Atomics.store(s,0,0);let r=Atomics.load(s,1),n=s[2],a=s[3],c=t+e.AUDIO_CAPTURE_HEADER_SIZE,l=new Float32Array(this.#t,c,r*a),u=new Float32Array(r),f=a>1?new Float32Array(r):null;for(let h=0;h<r;h++)u[h]=l[h*a],f&&(f[h]=l[h*a+1]);return{sampleRate:n,channels:a,frames:r,left:u,right:f}}isEnabled(){if(!this.isAvailable())return!1;let e=this.#e,t=this.#o+e.AUDIO_CAPTURE_START,s=new Uint32Array(this.#t,t,1);return Atomics.load(s,0)===1}getFrameCount(){if(!this.isAvailable())return 0;let e=this.#e,t=this.#o+e.AUDIO_CAPTURE_START,s=new Uint32Array(this.#t,t,2);return Atomics.load(s,1)}getMaxDuration(){if(!this.#e)return 0;let e=this.#e;return e.AUDIO_CAPTURE_FRAMES/(e.AUDIO_CAPTURE_SAMPLE_RATE||48e3)}};function Ie(i){let e,t,s;if(i&&typeof i.sharedBuffer<"u"&&typeof i.ringBufferBase<"u")e=i.sharedBuffer,t=i.ringBufferBase,s=i.bufferConstants;else if(i&&i.sab)e=i.sab,t=i.ringBufferBase??0,s=i.layout;else throw new Error("inspect() requires an instance or {sab, ringBufferBase, layout}");if(!e||!s)return{error:"Not initialized - sab or layout missing"};let r=new Int32Array(e),n=t+s.CONTROL_START,a={inHead:Atomics.load(r,(n+0)/4),inTail:Atomics.load(r,(n+4)/4),outHead:Atomics.load(r,(n+8)/4),outTail:Atomics.load(r,(n+12)/4),debugHead:Atomics.load(r,(n+16)/4),debugTail:Atomics.load(r,(n+20)/4),inSequence:Atomics.load(r,(n+24)/4),outSequence:Atomics.load(r,(n+28)/4),debugSequence:Atomics.load(r,(n+32)/4),statusFlags:Atomics.load(r,(n+36)/4),inWriteLock:Atomics.load(r,(n+40)/4)},c=new Float64Array(e,t+s.NTP_START_TIME_START,1),l=new Int32Array(e,t+s.DRIFT_OFFSET_START,1),u=new Int32Array(e,t+s.GLOBAL_OFFSET_START,1),f={ntpStartTime:c[0],driftOffsetMs:Atomics.load(l,0),globalOffsetMs:Atomics.load(u,0)},h=(a.inHead-a.inTail+s.IN_BUFFER_SIZE)%s.IN_BUFFER_SIZE,p=(a.outHead-a.outTail+s.OUT_BUFFER_SIZE)%s.OUT_BUFFER_SIZE,d=(a.debugHead-a.debugTail+s.DEBUG_BUFFER_SIZE)%s.DEBUG_BUFFER_SIZE,w={in:{bytes:h,percent:h/s.IN_BUFFER_SIZE*100},out:{bytes:p,percent:p/s.OUT_BUFFER_SIZE*100},debug:{bytes:d,percent:d/s.DEBUG_BUFFER_SIZE*100}},m=new Uint32Array(e,t+s.METRICS_START,s.METRICS_SIZE/4),g={processCount:m[0],messagesProcessed:m[1],messagesDropped:m[2],schedulerQueueDepth:m[3],schedulerQueueMax:m[4],schedulerQueueDropped:m[5]};return{layout:s,ringBufferBase:t,control:a,timing:f,bufferUsage:w,metrics:g,sabByteLength:e.byteLength}}function Pe(i,e,t){let s=t,r=new Uint32Array(i,e,2),n=r[0],a=r[1],c=e+s.NODE_TREE_HEADER_SIZE,l=s.NODE_TREE_MAX_NODES,u=s.NODE_TREE_ENTRY_SIZE,f=s.NODE_TREE_DEF_NAME_SIZE,h=new DataView(i,c,l*u),p=new TextDecoder("utf-8"),d=[],w=0;for(let m=0;m<l&&w<n;m++){let g=m*u,y=h.getInt32(g,!0);if(y===-1)continue;w++;let b=c+g+24,T=new Uint8Array(i,b,f),S=new Uint8Array(f);S.set(T);let E=S.indexOf(0);E===-1&&(E=f);let A=p.decode(S.subarray(0,E));d.push({id:y,parentId:h.getInt32(g+4,!0),isGroup:h.getInt32(g+8,!0)===1,prevId:h.getInt32(g+12,!0),nextId:h.getInt32(g+16,!0),headId:h.getInt32(g+20,!0),defName:A})}return{nodeCount:n,version:a,nodes:d}}var o={},o=o||{};(function(){"use strict";o.SECS_70YRS=2208988800,o.TWO_32=4294967296,o.defaults={metadata:!1,unpackSingleArgs:!0},o.isCommonJS=!!(typeof module<"u"&&module.exports),o.isNode=o.isCommonJS&&typeof window>"u",o.isElectron=!!(typeof process<"u"&&process.versions&&process.versions.electron),o.isBufferEnv=o.isNode||o.isElectron,o.isArray=function(i){return i&&Object.prototype.toString.call(i)==="[object Array]"},o.isTypedArrayView=function(i){return i.buffer&&i.buffer instanceof ArrayBuffer},o.isBuffer=function(i){return o.isBufferEnv&&i instanceof Buffer},o.Long=typeof Long<"u"?Long:void 0,o.TextDecoder=typeof TextDecoder<"u"?new TextDecoder("utf-8"):typeof util<"u"&&typeof(util.TextDecoder!=="undefined")?new util.TextDecoder("utf-8"):void 0,o.TextEncoder=typeof TextEncoder<"u"?new TextEncoder("utf-8"):typeof util<"u"&&typeof(util.TextEncoder!=="undefined")?new util.TextEncoder("utf-8"):void 0,o.dataView=function(i,e,t){return i.buffer?new DataView(i.buffer,e,t):i instanceof ArrayBuffer?new DataView(i,e,t):new DataView(new Uint8Array(i),e,t)},o.byteArray=function(i){if(i instanceof Uint8Array)return i;var e=i.buffer?i.buffer:i;if(!(e instanceof ArrayBuffer)&&(typeof e.length>"u"||typeof e=="string"))throw new Error("Can't wrap a non-array-like object as Uint8Array. Object was: "+JSON.stringify(i,null,2));return new Uint8Array(e)},o.nativeBuffer=function(i){return o.isBufferEnv?o.isBuffer(i)?i:Buffer.from(i.buffer?i:new Uint8Array(i)):o.isTypedArrayView(i)?i:new Uint8Array(i)},o.copyByteArray=function(i,e,t){if(o.isTypedArrayView(i)&&o.isTypedArrayView(e))e.set(i,t);else for(var s=t===void 0?0:t,r=Math.min(e.length-t,i.length),n=0,a=s;n<r;n++,a++)e[a]=i[n];return e},o.readString=function(i,e){for(var t=[],s=e.idx;s<i.byteLength;s++){var r=i.getUint8(s);if(r!==0)t.push(r);else{s++;break}}s=s+3&-4,e.idx=s;var n=o.isBufferEnv?o.readString.withBuffer:o.TextDecoder?o.readString.withTextDecoder:o.readString.raw;return n(t)},o.readString.raw=function(i){for(var e="",t=1e4,s=0;s<i.length;s+=t)e+=String.fromCharCode.apply(null,i.slice(s,s+t));return e},o.readString.withTextDecoder=function(i){var e=new Int8Array(i);return o.TextDecoder.decode(e)},o.readString.withBuffer=function(i){return Buffer.from(i).toString("utf-8")},o.writeString=function(i){var e=o.isBufferEnv?o.writeString.withBuffer:o.TextEncoder?o.writeString.withTextEncoder:null,t=i+"\0",s;e&&(s=e(t));for(var r=e?s.length:t.length,n=r+3&-4,a=new Uint8Array(n),c=0;c<r-1;c++){var l=e?s[c]:t.charCodeAt(c);a[c]=l}return a},o.writeString.withTextEncoder=function(i){return o.TextEncoder.encode(i)},o.writeString.withBuffer=function(i){return Buffer.from(i)},o.readPrimitive=function(i,e,t,s){var r=i[e](s.idx,!1);return s.idx+=t,r},o.writePrimitive=function(i,e,t,s,r){r=r===void 0?0:r;var n;return e?n=new Uint8Array(e.buffer):(n=new Uint8Array(s),e=new DataView(n.buffer)),e[t](r,i,!1),n},o.readInt32=function(i,e){return o.readPrimitive(i,"getInt32",4,e)},o.writeInt32=function(i,e,t){return o.writePrimitive(i,e,"setInt32",4,t)},o.readInt64=function(i,e){var t=o.readPrimitive(i,"getInt32",4,e),s=o.readPrimitive(i,"getInt32",4,e);return o.Long?new o.Long(s,t):{high:t,low:s,unsigned:!1}},o.writeInt64=function(i,e,t){var s=new Uint8Array(8);return s.set(o.writePrimitive(i.high,e,"setInt32",4,t),0),s.set(o.writePrimitive(i.low,e,"setInt32",4,t+4),4),s},o.readFloat32=function(i,e){return o.readPrimitive(i,"getFloat32",4,e)},o.writeFloat32=function(i,e,t){return o.writePrimitive(i,e,"setFloat32",4,t)},o.readFloat64=function(i,e){return o.readPrimitive(i,"getFloat64",8,e)},o.writeFloat64=function(i,e,t){return o.writePrimitive(i,e,"setFloat64",8,t)},o.readChar32=function(i,e){var t=o.readPrimitive(i,"getUint32",4,e);return String.fromCharCode(t)},o.writeChar32=function(i,e,t){var s=i.charCodeAt(0);if(!(s===void 0||s<-1))return o.writePrimitive(s,e,"setUint32",4,t)},o.readBlob=function(i,e){var t=o.readInt32(i,e),s=t+3&-4,r=new Uint8Array(i.buffer,e.idx,t);return e.idx+=s,r},o.writeBlob=function(i){i=o.byteArray(i);var e=i.byteLength,t=e+3&-4,s=4,r=t+s,n=new Uint8Array(r),a=new DataView(n.buffer);return o.writeInt32(e,a),n.set(i,s),n},o.readMIDIBytes=function(i,e){var t=new Uint8Array(i.buffer,e.idx,4);return e.idx+=4,t},o.writeMIDIBytes=function(i){i=o.byteArray(i);var e=new Uint8Array(4);return e.set(i),e},o.readColor=function(i,e){var t=new Uint8Array(i.buffer,e.idx,4),s=t[3]/255;return e.idx+=4,{r:t[0],g:t[1],b:t[2],a:s}},o.writeColor=function(i){var e=Math.round(i.a*255),t=new Uint8Array([i.r,i.g,i.b,e]);return t},o.readTrue=function(){return!0},o.readFalse=function(){return!1},o.readNull=function(){return null},o.readImpulse=function(){return 1},o.readTimeTag=function(i,e){var t=o.readPrimitive(i,"getUint32",4,e),s=o.readPrimitive(i,"getUint32",4,e),r=t===0&&s===1?Date.now():o.ntpToJSTime(t,s);return{raw:[t,s],native:r}},o.writeTimeTag=function(i){var e=i.raw?i.raw:o.jsToNTPTime(i.native),t=new Uint8Array(8),s=new DataView(t.buffer);return o.writeInt32(e[0],s,0),o.writeInt32(e[1],s,4),t},o.timeTag=function(i,e){i=i||0,e=e||Date.now();var t=e/1e3,s=Math.floor(t),r=t-s,n=Math.floor(i),a=i-n,c=r+a;if(c>1){var l=Math.floor(c),u=c-l;n+=l,c=u}var f=s+n+o.SECS_70YRS,h=Math.round(o.TWO_32*c);return{raw:[f,h]}},o.ntpToJSTime=function(i,e){var t=i-o.SECS_70YRS,s=e/o.TWO_32,r=(t+s)*1e3;return r},o.jsToNTPTime=function(i){var e=i/1e3,t=Math.floor(e),s=e-t,r=t+o.SECS_70YRS,n=Math.round(o.TWO_32*s);return[r,n]},o.readArguments=function(i,e,t){var s=o.readString(i,t);if(s.indexOf(",")!==0)throw new Error("A malformed type tag string was found while reading the arguments of an OSC message. String was: "+s," at offset: "+t.idx);var r=s.substring(1).split(""),n=[];return o.readArgumentsIntoArray(n,r,s,i,e,t),n},o.readArgument=function(i,e,t,s,r){var n=o.argumentTypes[i];if(!n)throw new Error("'"+i+"' is not a valid OSC type tag. Type tag string was: "+e);var a=n.reader,c=o[a](t,r);return s.metadata&&(c={type:i,value:c}),c},o.readArgumentsIntoArray=function(i,e,t,s,r,n){for(var a=0;a<e.length;){var c=e[a],l;if(c==="["){var u=e.slice(a+1),f=u.indexOf("]");if(f<0)throw new Error("Invalid argument type tag: an open array type tag ('[') was found without a matching close array tag ('[]'). Type tag was: "+t);var h=u.slice(0,f);l=o.readArgumentsIntoArray([],h,t,s,r,n),a+=f+2}else l=o.readArgument(c,t,s,r,n),a++;i.push(l)}return i},o.writeArguments=function(i,e){var t=o.collectArguments(i,e);return o.joinParts(t)},o.joinParts=function(i){for(var e=new Uint8Array(i.byteLength),t=i.parts,s=0,r=0;r<t.length;r++){var n=t[r];o.copyByteArray(n,e,s),s+=n.length}return e},o.addDataPart=function(i,e){e.parts.push(i),e.byteLength+=i.length},o.writeArrayArguments=function(i,e){for(var t="[",s=0;s<i.length;s++){var r=i[s];t+=o.writeArgument(r,e)}return t+="]",t},o.writeArgument=function(i,e){if(o.isArray(i))return o.writeArrayArguments(i,e);var t=i.type,s=o.argumentTypes[t].writer;if(s){var r=o[s](i.value);o.addDataPart(r,e)}return i.type},o.collectArguments=function(i,e,t){o.isArray(i)||(i=typeof i>"u"?[]:[i]),t=t||{byteLength:0,parts:[]},e.metadata||(i=o.annotateArguments(i));for(var s=",",r=t.parts.length,n=0;n<i.length;n++){var a=i[n];s+=o.writeArgument(a,t)}var c=o.writeString(s);return t.byteLength+=c.byteLength,t.parts.splice(r,0,c),t},o.readMessage=function(i,e,t){e=e||o.defaults;var s=o.dataView(i,i.byteOffset,i.byteLength);t=t||{idx:0};var r=o.readString(s,t);return o.readMessageContents(r,s,e,t)},o.readMessageContents=function(i,e,t,s){if(i.indexOf("/")!==0)throw new Error("A malformed OSC address was found while reading an OSC message. String was: "+i);var r=o.readArguments(e,t,s);return{address:i,args:r.length===1&&t.unpackSingleArgs?r[0]:r}},o.collectMessageParts=function(i,e,t){return t=t||{byteLength:0,parts:[]},o.addDataPart(o.writeString(i.address),t),o.collectArguments(i.args,e,t)},o.writeMessage=function(i,e){if(e=e||o.defaults,!o.isValidMessage(i))throw new Error("An OSC message must contain a valid address. Message was: "+JSON.stringify(i,null,2));var t=o.collectMessageParts(i,e);return o.joinParts(t)},o.isValidMessage=function(i){return i.address&&i.address.indexOf("/")===0},o.readBundle=function(i,e,t){return o.readPacket(i,e,t)},o.collectBundlePackets=function(i,e,t){t=t||{byteLength:0,parts:[]},o.addDataPart(o.writeString("#bundle"),t),o.addDataPart(o.writeTimeTag(i.timeTag),t);for(var s=0;s<i.packets.length;s++){var r=i.packets[s],n=r.address?o.collectMessageParts:o.collectBundlePackets,a=n(r,e);t.byteLength+=a.byteLength,o.addDataPart(o.writeInt32(a.byteLength),t),t.parts=t.parts.concat(a.parts)}return t},o.writeBundle=function(i,e){if(!o.isValidBundle(i))throw new Error("An OSC bundle must contain 'timeTag' and 'packets' properties. Bundle was: "+JSON.stringify(i,null,2));e=e||o.defaults;var t=o.collectBundlePackets(i,e);return o.joinParts(t)},o.isValidBundle=function(i){return i.timeTag!==void 0&&i.packets!==void 0},o.readBundleContents=function(i,e,t,s){for(var r=o.readTimeTag(i,t),n=[];t.idx<s;){var a=o.readInt32(i,t),c=t.idx+a,l=o.readPacket(i,e,t,c);n.push(l)}return{timeTag:r,packets:n}},o.readPacket=function(i,e,t,s){var r=o.dataView(i,i.byteOffset,i.byteLength);s=s===void 0?r.byteLength:s,t=t||{idx:0};var n=o.readString(r,t),a=n[0];if(a==="#")return o.readBundleContents(r,e,t,s);if(a==="/")return o.readMessageContents(n,r,e,t);throw new Error("The header of an OSC packet didn't contain an OSC address or a #bundle string. Header was: "+n)},o.writePacket=function(i,e){if(o.isValidMessage(i))return o.writeMessage(i,e);if(o.isValidBundle(i))return o.writeBundle(i,e);throw new Error("The specified packet was not recognized as a valid OSC message or bundle. Packet was: "+JSON.stringify(i,null,2))},o.argumentTypes={i:{reader:"readInt32",writer:"writeInt32"},h:{reader:"readInt64",writer:"writeInt64"},f:{reader:"readFloat32",writer:"writeFloat32"},s:{reader:"readString",writer:"writeString"},S:{reader:"readString",writer:"writeString"},b:{reader:"readBlob",writer:"writeBlob"},t:{reader:"readTimeTag",writer:"writeTimeTag"},T:{reader:"readTrue"},F:{reader:"readFalse"},N:{reader:"readNull"},I:{reader:"readImpulse"},d:{reader:"readFloat64",writer:"writeFloat64"},c:{reader:"readChar32",writer:"writeChar32"},r:{reader:"readColor",writer:"writeColor"},m:{reader:"readMIDIBytes",writer:"writeMIDIBytes"}},o.inferTypeForArgument=function(i){var e=typeof i;switch(e){case"boolean":return i?"T":"F";case"string":return"s";case"number":return"f";case"undefined":return"N";case"object":if(i===null)return"N";if(i instanceof Uint8Array||i instanceof ArrayBuffer)return"b";if(typeof i.high=="number"&&typeof i.low=="number")return"h";break}throw new Error("Can't infer OSC argument type for value: "+JSON.stringify(i,null,2))},o.annotateArguments=function(i){for(var e=[],t=0;t<i.length;t++){var s=i[t],r;if(typeof s=="object"&&s.type&&s.value!==void 0)r=s;else if(o.isArray(s))r=o.annotateArguments(s);else{var n=o.inferTypeForArgument(s);r={type:n,value:s}}e.push(r)}return e}})();var P=function(){};P.prototype.on=function(){};P.prototype.emit=function(){};P.prototype.removeListener=function(){};(function(){"use strict";o.supportsSerial=!1,o.firePacketEvents=function(e,t,s,r){t.address?e.emit("message",t,s,r):o.fireBundleEvents(e,t,s,r)},o.fireBundleEvents=function(e,t,s,r){e.emit("bundle",t,s,r);for(var n=0;n<t.packets.length;n++){var a=t.packets[n];o.firePacketEvents(e,a,t.timeTag,r)}},o.fireClosedPortSendError=function(e,t){t=t||"Can't send packets on a closed osc.Port object. Please open (or reopen) this Port by calling open().",e.emit("error",t)},o.Port=function(e){this.options=e||{},this.on("data",this.decodeOSC.bind(this))};var i=o.Port.prototype=Object.create(P.prototype);i.constructor=o.Port,i.send=function(e){var t=Array.prototype.slice.call(arguments),s=this.encodeOSC(e),r=o.nativeBuffer(s);t[0]=r,this.sendRaw.apply(this,t)},i.encodeOSC=function(e){e=e.buffer?e.buffer:e;var t;try{t=o.writePacket(e,this.options)}catch(s){this.emit("error",s)}return t},i.decodeOSC=function(e,t){e=o.byteArray(e),this.emit("raw",e,t);try{var s=o.readPacket(e,this.options);this.emit("osc",s,t),o.firePacketEvents(this,s,void 0,t)}catch(r){this.emit("error",r)}},o.SLIPPort=function(e){var t=this,s=this.options=e||{};s.useSLIP=s.useSLIP===void 0?!0:s.useSLIP,this.decoder=new slip.Decoder({onMessage:this.decodeOSC.bind(this),onError:function(n){t.emit("error",n)}});var r=s.useSLIP?this.decodeSLIPData:this.decodeOSC;this.on("data",r.bind(this))},i=o.SLIPPort.prototype=Object.create(o.Port.prototype),i.constructor=o.SLIPPort,i.encodeOSC=function(e){e=e.buffer?e.buffer:e;var t;try{var s=o.writePacket(e,this.options);t=slip.encode(s)}catch(r){this.emit("error",r)}return t},i.decodeSLIPData=function(e,t){this.decoder.decode(e,t)},o.relay=function(e,t,s,r,n,a){s=s||"message",r=r||"send",n=n||function(){},a=a?[null].concat(a):[];var c=function(l){a[0]=l,l=n(l),t[r].apply(t,a)};return e.on(s,c),{eventName:s,listener:c}},o.relayPorts=function(e,t,s){var r=s.raw?"raw":"osc",n=s.raw?"sendRaw":"send";return o.relay(e,t,r,n,s.transform)},o.stopRelaying=function(e,t){e.removeListener(t.eventName,t.listener)},o.Relay=function(e,t,s){var r=this.options=s||{};r.raw=!1,this.port1=e,this.port2=t,this.listen()},i=o.Relay.prototype=Object.create(P.prototype),i.constructor=o.Relay,i.open=function(){this.port1.open(),this.port2.open()},i.listen=function(){this.port1Spec&&this.port2Spec&&this.close(),this.port1Spec=o.relayPorts(this.port1,this.port2,this.options),this.port2Spec=o.relayPorts(this.port2,this.port1,this.options);var e=this.close.bind(this);this.port1.on("close",e),this.port2.on("close",e)},i.close=function(){o.stopRelaying(this.port1,this.port1Spec),o.stopRelaying(this.port2,this.port2Spec),this.emit("close",this.port1,this.port2)}})();(function(){"use strict";o.WebSocket=typeof WebSocket<"u"?WebSocket:void 0,o.WebSocketPort=function(e){o.Port.call(this,e),this.on("open",this.listen.bind(this)),this.socket=e.socket,this.socket&&(this.socket.readyState===1?(o.WebSocketPort.setupSocketForBinary(this.socket),this.emit("open",this.socket)):this.open())};var i=o.WebSocketPort.prototype=Object.create(o.Port.prototype);i.constructor=o.WebSocketPort,i.open=function(){(!this.socket||this.socket.readyState>1)&&(this.socket=new o.WebSocket(this.options.url)),o.WebSocketPort.setupSocketForBinary(this.socket);var e=this;this.socket.onopen=function(){e.emit("open",e.socket)},this.socket.onerror=function(t){e.emit("error",t)}},i.listen=function(){var e=this;this.socket.onmessage=function(t){e.emit("data",t.data,t)},this.socket.onclose=function(t){e.emit("close",t)},e.emit("ready")},i.sendRaw=function(e){if(!this.socket||this.socket.readyState!==1){o.fireClosedPortSendError(this);return}this.socket.send(e)},i.close=function(e,t){this.socket.close(e,t)},o.WebSocketPort.setupSocketForBinary=function(e){e.binaryType=o.isNode?"nodebuffer":"arraybuffer"}})();var V=o,{readPacket:gs,writePacket:ws,readMessage:ys,writeMessage:Ss,readBundle:Es,writeBundle:bs}=o;var xe={totalPages:1280,ringBufferReserved:3145728,bufferPoolOffset:19922944,bufferPoolSize:63963136,get totalMemory(){return this.bufferPoolOffset+this.bufferPoolSize},get wasmHeapSize(){return this.bufferPoolOffset-this.ringBufferReserved}};var Le={numBuffers:1024,maxNodes:1024,maxGraphDefs:1024,maxWireBufs:64,numAudioBusChannels:128,numInputBusChannels:2,numOutputBusChannels:2,numControlBusChannels:4096,bufLength:128,realTimeMemorySize:8192,numRGens:64,realTime:!1,memoryLocking:!1,loadGraphDefs:0,preferredSampleRate:0,verbosity:0};var ne=import.meta.url;function wt(){try{let i=ne.substring(0,ne.lastIndexOf("/")+1),e=ne.match(/^(https:\/\/unpkg\.com\/)supersonic-scsynth@([^/]+)\/dist\/supersonic\.js$/);if(e){let t=e[1],s=e[2];return{baseURL:i,coreBaseURL:`${t}supersonic-scsynth-core@${s}/`,sampleBaseURL:`${t}supersonic-scsynth-samples@${s}/samples/`,synthdefBaseURL:`${t}supersonic-scsynth-synthdefs@${s}/synthdefs/`}}return{baseURL:i,coreBaseURL:null,sampleBaseURL:null,synthdefBaseURL:null}}catch{return{baseURL:null,coreBaseURL:null,sampleBaseURL:null,synthdefBaseURL:null}}}var H=wt(),ke=class i{static osc={encode:e=>V.writePacket(e),decode:(e,t={metadata:!1})=>V.readPacket(e,t)};static inspect(e){return Ie(e)}#t;#e;#o=null;#i;#h;#r;#m;#a;#n;#l;#d;#y;#f;#w;#g;#p;#E;#s;#c;#u;#S;#T;#A;#_=null;#B=!1;#O=100;#D=null;#M=null;#z=0;#R=[];#v=null;constructor(e={}){this.#f=!1,this.#w=!1,this.#g=null,this.#p={},this.#E=null,this.#c=new N,this.#u=new z({mode:e.mode||"postMessage"}),this.#T=new $({}),this.#t=null,this.#e=null,this.#i=null,this.#r=null,this.loadedSynthDefs=new Map;let t=e.baseURL||H.baseURL,s=e.coreBaseURL||H.coreBaseURL||t,r=e.workerBaseURL||(s?`${s}workers/`:null),n=e.wasmBaseURL||(s?`${s}wasm/`:null);if(!r||!n)throw new Error("SuperSonic requires coreBaseURL, baseURL, or explicit workerBaseURL and wasmBaseURL options.");let a={...Le,...e.scsynthOptions},c=e.mode||"postMessage";this.#s={mode:c,snapshotIntervalMs:e.snapshotIntervalMs??25,wasmUrl:e.wasmUrl||n+"scsynth-nrt.wasm",wasmBaseURL:n,workletUrl:e.workletUrl||r+"scsynth_audio_worklet.js",workerBaseURL:r,audioContext:e.audioContext||null,autoConnect:e.autoConnect!==!1,audioContextOptions:{latencyHint:"interactive",sampleRate:48e3},memory:xe,worldOptions:a,preschedulerCapacity:e.preschedulerCapacity||65536,activityEvent:{maxLineLength:e.activityEvent?.maxLineLength??200,scsynthMaxLineLength:e.activityEvent?.scsynthMaxLineLength??null,oscInMaxLineLength:e.activityEvent?.oscInMaxLineLength??null,oscOutMaxLineLength:e.activityEvent?.oscOutMaxLineLength??null},debug:e.debug??!1,debugScsynth:e.debugScsynth??!1,debugOscIn:e.debugOscIn??!1,debugOscOut:e.debugOscOut??!1,activityConsoleLog:{maxLineLength:e.activityConsoleLog?.maxLineLength??200,scsynthMaxLineLength:e.activityConsoleLog?.scsynthMaxLineLength??null,oscInMaxLineLength:e.activityConsoleLog?.oscInMaxLineLength??null,oscOutMaxLineLength:e.activityConsoleLog?.oscOutMaxLineLength??null}},this.#n=e.sampleBaseURL||H.sampleBaseURL||(t?`${t}samples/`:null),this.#l=e.synthdefBaseURL||H.synthdefBaseURL||(t?`${t}synthdefs/`:null),this.#d={maxRetries:e.fetchMaxRetries??3,baseDelay:e.fetchRetryDelay??1e3},this.#y=new k({onLoadingEvent:(l,u)=>this.#c.emit(l,u),maxRetries:this.#d.maxRetries,baseDelay:this.#d.baseDelay}),this.bootStats={initStartTime:null,initDuration:null}}get initialized(){return this.#f}get initializing(){return this.#w}get mode(){return this.#s.mode}get bufferConstants(){return this.#u.bufferConstants}get ringBufferBase(){return this.#u.ringBufferBase}get sharedBuffer(){return this.#u.sharedBuffer}get node(){return this.#o}get osc(){return this.#i}on(e,t){return this.#c.on(e,t)}off(e,t){return this.#c.off(e,t),this}once(e,t){return this.#c.once(e,t),this}removeAllListeners(e){return this.#c.removeAllListeners(e),this}async init(){if(!this.#f)return this.#g?this.#g:(this.#g=this.#W(),this.#g)}async#W(){this.#w=!0,this.bootStats.initStartTime=performance.now();try{this.#H(),this.#G(),this.#I(),this.#q(),this.#P();let e=await this.#x();await this.#L(e),await this.#k(),this.#C(),await this.#F()}catch(e){throw this.#w=!1,this.#g=null,console.error("[SuperSonic] Initialization failed:",e),this.#c.emit("error",e),e}}getMetrics(){return this.#N()}setMetricsInterval(e){this.#O=e,this.#C()}stopMetricsPolling(){this.#U()}async recover(){return this.#f?await this.resume()?!0:await this.reload():!1}async resume(){if(!this.#f||!this.#t||!this.#u.getMetricsView())return!1;try{await this.#t.resume()}catch{}let e=this.#u.getMetricsView(),t=e[0];await new Promise(n=>setTimeout(n,200));let r=e[0]>t;return r&&(this.#S.resync(),this.#c.emit("resumed")),r}async reload(){if(!this.#f)return!1;this.#c.emit("reload:start");let e=new Map(this.loadedSynthDefs),t=this.#r?.getAllocatedBuffers()||[];await this.#$(),await this.#V();for(let[s,r]of e)try{await this.send("/d_recv",r)}catch(n){console.error(`[SuperSonic] Failed to restore synthdef ${s}:`,n)}for(let s of t)try{if(this.#s.mode==="postMessage"&&s.source)s.source.type==="file"&&await this.loadSample(s.bufnum,s.source.path,s.source.startFrame||0,s.source.numFrames||0);else{let r=crypto.randomUUID();await this.send("/b_allocPtr",s.bufnum,s.ptr,s.numFrames,s.numChannels,s.sampleRate,r)}}catch(r){console.error(`[SuperSonic] Failed to restore buffer ${s.bufnum}:`,r)}return(e.size>0||t.length>0)&&await this.sync(),this.#c.emit("reload:complete",{success:!0}),!0}async#$(){this.#S?.stopDriftTimer(),this.#U(),this.#a?.clear(),this.#a=null,this.#i&&(this.#i.cancelAll(),this.#i.dispose(),this.#i=null),this.#e&&(this.#e.disconnect(),this.#e=null),this.#t&&(await this.#t.close(),this.#t=null),this.#f=!1,this.loadedSynthDefs.clear(),this.#g=null,this.#A=null,this.#S?.reset()}async#V(){this.#w=!0,this.bootStats.initStartTime=performance.now();try{this.#I(),this.#r&&this.#r.updateAudioContext(this.#t),this.#P();let e=await this.#x();await this.#L(e),await this.#k(),this.#C(),await this.#F()}catch(e){throw this.#w=!1,this.#g=null,console.error("[SuperSonic] Partial init failed:",e),this.#c.emit("error",e),e}}getTree(){if(!this.#f)return{nodeCount:0,version:0,nodes:[]};let e=this.#u.bufferConstants;if(!e)return{nodeCount:0,version:0,nodes:[]};let t,s;if(this.#s.mode==="postMessage"){let r=this.#u.getSnapshotBuffer();if(!r)return{nodeCount:0,version:0,nodes:[]};t=r,s=e.METRICS_SIZE}else{let r=this.#u.sharedBuffer;if(!r)return{nodeCount:0,version:0,nodes:[]};t=r,s=this.#u.ringBufferBase+e.NODE_TREE_START}return Pe(t,s,e)}startCapture(){this.#b("start capture"),this.#T.start()}stopCapture(){return this.#b("stop capture"),this.#T.stop()}isCaptureEnabled(){return this.#T.isEnabled()}getCaptureFrames(){return this.#T.getFrameCount()}getMaxCaptureDuration(){return this.#T.getMaxDuration()}async send(e,...t){this.#b("send OSC messages");let s={"/d_load":"Use loadSynthDef() or send /d_recv with synthdef bytes instead.","/d_loadDir":"Use loadSynthDef() or send /d_recv with synthdef bytes instead.","/b_read":"Use loadSample() to load audio into a buffer.","/b_readChannel":"Use loadSample() to load audio into a buffer.","/b_write":"Writing audio files is not available in the browser.","/b_close":"Writing audio files is not available in the browser.","/clearSched":"Use cancelAllScheduled() or the fine-grained cancelTag(), cancelSession(), cancelSessionTag() methods instead.","/dumpOSC":"Use browser developer tools to inspect OSC messages.","/error":"SuperSonic always enables error notifications so you never miss a /fail message."};if(s[e])throw new Error(`${e} is not supported in SuperSonic. ${s[e]}`);if(e==="/d_recv"){let c=t[0];if(c instanceof Uint8Array||c instanceof ArrayBuffer){let l=c instanceof ArrayBuffer?new Uint8Array(c):c,u=X(l)||"unknown";this.loadedSynthDefs.set(u,l)}}if(e==="/d_free")for(let c of t)typeof c=="string"&&this.loadedSynthDefs.delete(c);else e==="/d_freeAll"&&this.loadedSynthDefs.clear();let r=t.map(c=>{if(typeof c=="string")return{type:"s",value:c};if(typeof c=="number")return{type:Number.isInteger(c)?"i":"f",value:c};if(c instanceof Uint8Array||c instanceof ArrayBuffer)return{type:"b",value:c instanceof ArrayBuffer?new Uint8Array(c):c};throw new Error(`Unsupported argument type: ${typeof c}`)}),n={address:e,args:r},a=i.osc.encode(n);if(this.#s.debug||this.#s.debugOscOut){let c=this.#s.activityConsoleLog.oscOutMaxLineLength??this.#s.activityConsoleLog.maxLineLength,l=t.map(u=>{if(u instanceof Uint8Array||u instanceof ArrayBuffer)return`<${u.byteLength||u.length} bytes>`;let f=JSON.stringify(u);return f.length>c?f.slice(0,c)+"...":f}).join(", ");console.log(`[OSC \u2192] ${e}${l?" "+l:""}`)}return this.sendOSC(a)}async sendOSC(e,t={}){this.#b("send OSC data");let s=this.#K(e),r=await this.#X(s);if(this.#u.addMetric("mainMessagesSent"),this.#u.addMetric("mainBytesSent",r.length),this.#c.emit("message:sent",r),this.#A?.tryWrite(r)){this.#u.addMetric("preschedulerBypassed");return}let n=this.#S?.calculateBundleWait(r);if(this.#s.mode==="postMessage"&&!n){this.#e.port.postMessage({type:"osc",oscData:r});return}let a=this.#u.bufferConstants?.scheduler_slot_size;if(n&&a&&r.length>a)throw new Error(`OSC bundle too large to schedule (${r.length} > ${a} bytes). Use immediate timestamp (0 or 1) for large messages, or reduce bundle size.`);let c={...t};n&&(c.audioTimeS=n.audioTimeS,c.currentTimeS=n.currentTimeS),this.#i.sendWithOptions(r,c)}cancelTag(e){this.#b("cancel by tag"),this.#i.cancelTag(e)}cancelSession(e){this.#b("cancel by session"),this.#i.cancelSession(e)}cancelSessionTag(e,t){this.#b("cancel by session and tag"),this.#i.cancelSessionTag(e,t)}cancelAllScheduled(){this.#b("cancel all scheduled"),this.#i.cancelAll()}async loadSynthDef(e){this.#b("load synthdef");let t;if(this.#j(e))t=e;else{if(!this.#l)throw new Error("synthdefBaseURL not configured.");t=`${this.#l}${e}.scsyndef`}let s=X(t),r=await this.#y.fetch(t,{type:"synthdef",name:s}),n=new Uint8Array(r);return await this.send("/d_recv",n),{name:s,size:n.length}}async loadSynthDefs(e){this.#b("load synthdefs");let t={};return await Promise.all(e.map(async s=>{try{await this.loadSynthDef(s),t[s]={success:!0}}catch(r){t[s]={success:!1,error:r.message}}})),t}async loadSample(e,t,s=0,r=0){this.#b("load samples");let n=await this.#r.prepareFromFile({bufnum:e,path:t,startFrame:s,numFrames:r});return await this.send("/b_allocPtr",e,n.ptr,n.numFrames,n.numChannels,n.sampleRate,n.uuid),n.allocationComplete}async sync(e=Math.floor(Math.random()*2147483647)){this.#b("sync");let t=new Promise((s,r)=>{let n=setTimeout(()=>{this.#a?.delete(e),r(new Error("Timeout waiting for /synced response"))},1e4),a=()=>{clearTimeout(n),this.#a.delete(e),s()};this.#a||(this.#a=new Map),this.#a.set(e,a)});await this.send("/sync",e),await t,this.#s.mode==="postMessage"&&await new Promise(s=>setTimeout(s,this.#s.snapshotIntervalMs*2))}getInfo(){return this.#b("get info"),{sampleRate:this.#t.sampleRate,numBuffers:this.#s.worldOptions.numBuffers,totalMemory:this.#s.memory.totalMemory,wasmHeapSize:this.#s.memory.wasmHeapSize,bufferPoolSize:this.#s.memory.bufferPoolSize,bootTimeMs:this.bootStats.initDuration,capabilities:{...this.#p},version:this.#E}}async shutdown(){!this.#f&&!this.#w||(this.#c.emit("shutdown"),this.#S?.stopDriftTimer(),this.#U(),this.#a?.clear(),this.#a=null,this.#i&&(this.#i.cancelAll(),this.#i.dispose(),this.#i=null),this.#e&&(this.#e.disconnect(),this.#e=null),this.#t&&(await this.#t.close(),this.#t=null),this.#r&&(this.#r.destroy(),this.#r=null),this.#m=null,this.#A=null,this.#f=!1,this.loadedSynthDefs.clear(),this.#g=null,this.#h=null,this.#S?.reset(),this.bootStats={initStartTime:null,initDuration:null})}async destroy(){this.#c.emit("destroy"),await this.shutdown(),this.#M=null,this.#c.clearAllListeners()}async reset(e={}){await this.shutdown(),await this.init(e)}#H(){this.#p={audioWorklet:typeof AudioWorklet<"u",sharedArrayBuffer:typeof SharedArrayBuffer<"u",crossOriginIsolated:window.crossOriginIsolated===!0,atomics:typeof Atomics<"u",webWorker:typeof Worker<"u"};let e=this.#s.mode,t=["audioWorklet","webWorker"];e==="sab"&&t.push("sharedArrayBuffer","crossOriginIsolated","atomics");let s=t.filter(r=>!this.#p[r]);if(s.length>0){let r=new Error(`Missing required features for ${e} mode: ${s.join(", ")}`);throw e==="sab"&&!this.#p.crossOriginIsolated&&(r.message+=`

Consider using mode: 'postMessage' which doesn't require COOP/COEP headers.`),r}if(e!=="sab"&&e!=="postMessage")throw new Error(`Invalid mode: '${e}'. Use 'sab' or 'postMessage'.`)}#G(){let e=this.#s.memory;this.#s.mode==="sab"?this.#h=new WebAssembly.Memory({initial:e.totalPages,maximum:e.totalPages,shared:!0}):this.#h=null}#I(){this.#s.audioContext?this.#t=this.#s.audioContext:this.#t=new AudioContext(this.#s.audioContextOptions),this.#t.addEventListener("statechange",()=>{let e=this.#t?.state;if(!e)return;let t=this.#D;this.#D=e,e==="running"&&(t==="suspended"||t==="interrupted")&&this.#S?.resync(),this.#c.emit("audiocontext:statechange",{state:e}),e==="suspended"?this.#c.emit("audiocontext:suspended"):e==="running"?this.#c.emit("audiocontext:resumed"):e==="interrupted"&&this.#c.emit("audiocontext:interrupted")})}#q(){let e=this.#s.mode==="sab"?this.#h.buffer:null;this.#r=new L({mode:this.#s.mode,audioContext:this.#t,sharedBuffer:e,bufferPoolConfig:{start:this.#s.memory.bufferPoolOffset,size:this.#s.memory.bufferPoolSize},sampleBaseURL:this.#n,maxBuffers:this.#s.worldOptions.numBuffers,assetLoader:this.#y})}#P(){this.#m=new F({bufferManager:this.#r,getDefaultSampleRate:()=>this.#t?.sampleRate||44100})}async#x(){if(this.#M)return this.#M;let e=this.#s.wasmUrl.split("/").pop();this.#c.emit("loading:start",{type:"wasm",name:e});let t=await fetch(this.#s.wasmUrl);if(!t.ok)throw new Error(`Failed to load WASM: ${t.status} ${t.statusText}`);let s=await t.arrayBuffer();return this.#c.emit("loading:complete",{type:"wasm",name:e,size:s.byteLength}),this.#M=s,s}async#L(e){await he(this.#t.audioWorklet,this.#s.workletUrl),this.#e=new AudioWorkletNode(this.#t,"scsynth-processor",{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[2]}),this.#s.autoConnect&&this.#e.connect(this.#t.destination),this.#o=this.#Z(),this.#e.port.start(),this.#Q();let t=this.#s.mode,s=t==="sab"?this.#h.buffer:null;this.#e.port.postMessage({type:"init",mode:t,sharedBuffer:s,snapshotIntervalMs:this.#s.snapshotIntervalMs});let r={type:"loadWasm",wasmBytes:e,worldOptions:this.#s.worldOptions,sampleRate:this.#t.sampleRate};t==="sab"?r.wasmMemory=this.#h:r.memoryPages=this.#s.memoryPages||1280,this.#e.port.postMessage(r),await this.#Y(),this.#r.setWorkletPort(this.#e.port)}#Z(){let e=this.#e;return Object.freeze({connect:(...t)=>e.connect(...t),disconnect:(...t)=>e.disconnect(...t),get context(){return e.context},get numberOfOutputs(){return e.numberOfOutputs},get numberOfInputs(){return e.numberOfInputs},get channelCount(){return e.channelCount},get input(){return e}})}async#k(){let e=this.#s.mode,t=this.#u.bufferConstants,s=this.#u.ringBufferBase,r=this.#u.sharedBuffer,n={workerBaseURL:this.#s.workerBaseURL,preschedulerCapacity:this.#s.preschedulerCapacity,getAudioContextTime:()=>this.#t?.currentTime??0,getNTPStartTime:()=>this.#S?.getNTPStartTime()??0};if(e==="sab"&&(n.sharedBuffer=r,n.ringBufferBase=s,n.bufferConstants=t),this.#i=fe(e,n),this.#i.onReply((a,c)=>{this.#c.emit("message:raw",{oscData:a,sequence:c});try{let l={metadata:!1,unpackSingleArgs:!1},u=V.readPacket(a,l);if(u.address==="/supersonic/buffer/freed")this.#r?.handleBufferFreed(u.args);else if(u.address==="/supersonic/buffer/allocated")this.#r?.handleBufferAllocated(u.args);else if(u.address==="/synced"&&u.args.length>0){let f=u.args[0];this.#a?.has(f)&&this.#a.get(f)(u)}if(this.#c.emit("message",u),this.#s.debug||this.#s.debugOscIn){let f=this.#s.activityConsoleLog.oscInMaxLineLength??this.#s.activityConsoleLog.maxLineLength,h=u.args?.map(p=>{let d=JSON.stringify(p);return d.length>f?d.slice(0,f)+"...":d}).join(", ")||"";console.log(`[\u2190 OSC] ${u.address}${h?" "+h:""}`)}}catch(l){console.error("[SuperSonic] Failed to decode OSC message:",l)}}),this.#i.onDebug(a=>{let c=this.#s.activityEvent.scsynthMaxLineLength??this.#s.activityEvent.maxLineLength;if(c>0&&a.text?.length>c&&(a={...a,text:a.text.slice(0,c)+"..."}),this.#c.emit("debug",a),this.#s.debug||this.#s.debugScsynth){let l=this.#s.activityConsoleLog.scsynthMaxLineLength??this.#s.activityConsoleLog.maxLineLength,u=a.text.length>l?a.text.slice(0,l)+"...":a.text;console.log(`[synth] ${u}`)}}),this.#i.onError((a,c)=>{console.error(`[SuperSonic] ${c} error:`,a),this.#c.emit("error",new Error(`${c}: ${a}`))}),e==="sab")await this.#i.initialize();else{if(await this.#i.initialize(this.#e.port),this.#R?.length>0)for(let a of this.#R)this.#i.handleDebugRaw(a);this.#v=a=>this.#i.handleDebugRaw(a),this.#R=[]}}async#F(){this.#f=!0,this.#w=!1,this.bootStats.initDuration=performance.now()-this.bootStats.initStartTime,await this.#c.emitAsync("setup"),this.#c.emit("ready",{capabilities:this.#p,bootStats:this.bootStats})}#Y(){return new Promise((e,t)=>{let s=setTimeout(()=>{t(new Error("AudioWorklet initialization timeout"))},5e3),r=async n=>{if(n.data.type==="error"){clearTimeout(s),this.#e.port.removeEventListener("message",r),t(new Error(n.data.error||"AudioWorklet error"));return}if(n.data.type==="initialized")if(clearTimeout(s),this.#e.port.removeEventListener("message",r),n.data.success){let a=n.data.ringBufferBase??0,c=n.data.bufferConstants,l=this.#s.mode==="sab"?this.#h.buffer:null;this.#u.initSharedViews(l,a,c),this.#S=new W({mode:this.#s.mode,audioContext:this.#t,workletPort:this.#e.port}),this.#S.initSharedViews(l,a,c),await this.#S.initialize(),this.#S.startDriftTimer(),this.#s.mode==="sab"&&(this.#T.update(l,a,c),this.#A=new M({sharedBuffer:l,ringBufferBase:a,bufferConstants:c,getAudioContextTime:()=>this.#t?.currentTime??null,getNTPStartTime:()=>this.#S?.getNTPStartTime()??0})),this.#s.mode==="postMessage"&&n.data.initialSnapshot&&this.#u.updateSnapshot(n.data.initialSnapshot),e()}else t(new Error(n.data.error||"AudioWorklet initialization failed"))};this.#e.port.addEventListener("message",r),this.#e.port.start()})}#Q(){this.#e.port.addEventListener("message",e=>{let{data:t}=e;switch(t.type){case"error":console.error("[Worklet] Error:",t.error),this.#c.emit("error",new Error(t.error));break;case"version":this.#E=t.version;break;case"snapshot":t.buffer&&(this.#u.updateSnapshot(t.buffer),this.#z=t.snapshotsSent);break;case"debugRawBatch":this.#v?this.#v(t):this.#R.push(t);break}})}#N(){let e=this.#i?.getPreschedulerMetrics();return this.#u.gatherMetrics({preschedulerMetrics:e,driftOffsetMs:0,audioContextState:this.#t?.state||"unknown",bufferPoolStats:this.#r?.getStats(),loadedSynthDefsCount:this.loadedSynthDefs?.size||0})}#C(){this.#U();let e=this.mode==="postMessage"?1e3:this.#O;this.#_=setInterval(()=>{if(this.#c.hasListeners("metrics")&&!this.#B){this.#B=!0;try{let t=this.#N();this.#c.emit("metrics",t)}finally{this.#B=!1}}},e)}#U(){this.#_&&(clearInterval(this.#_),this.#_=null)}#b(e="perform this operation"){if(!this.#f)throw new Error(`SuperSonic not initialized. Call init() before attempting to ${e}.`)}#j(e){return e.includes("/")||e.includes("://")}#K(e){if(e instanceof Uint8Array)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new Error("oscData must be ArrayBuffer or Uint8Array")}async#X(e){let t={metadata:!0,unpackSingleArgs:!1};try{let s=i.osc.decode(e,t),{packet:r,changed:n}=await this.#m.rewritePacket(s);return n?i.osc.encode(r):e}catch(s){throw console.error("[SuperSonic] Failed to prepare OSC packet:",s),s}}};export{ke as SuperSonic};
/*! osc.js 2.4.5, Copyright 2024 Colin Clark | github.com/colinbdclark/osc.js */
